<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Kite Simulator - ECS Pure</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: #0a0e27;
      overflow: hidden;
      color: #e0e0e0;
    }
    
    #simulation-canvas {
      display: block;
      width: 100vw;
      height: 100vh;
    }

    .panel {
      position: absolute;
      top: 20px;
      background: rgba(15, 20, 45, 0.85);
      backdrop-filter: blur(8px);
      padding: 12px 14px;
      border-radius: 8px;
      font-size: 12px;
      line-height: 1.4;
      width: 320px;
      border: 1px solid rgba(100, 150, 255, 0.2);
      max-height: 90vh;
      overflow-y: auto;
      box-shadow: 0 8px 32px rgba(0, 0, 0, 0.4);
    }

    .panel::-webkit-scrollbar {
      width: 6px;
    }

    .panel::-webkit-scrollbar-track {
      background: rgba(100, 150, 255, 0.05);
      border-radius: 3px;
    }

    .panel::-webkit-scrollbar-thumb {
      background: rgba(100, 150, 255, 0.3);
      border-radius: 3px;
    }

    .panel::-webkit-scrollbar-thumb:hover {
      background: rgba(100, 150, 255, 0.5);
    }

    #info-panel {
      left: 20px;
      width: 280px;
    }

    #controls-panel {
      right: 20px;
      width: 380px;
    }
    
    .panel h2 {
      margin: 0 0 8px 0;
      font-size: 15px;
      font-weight: 600;
      border-bottom: 2px solid rgba(100, 150, 255, 0.3);
      padding-bottom: 6px;
      color: #4da6ff;
    }

    .panel h3 {
      margin: 10px 0 6px 0;
      font-size: 11px;
      font-weight: 600;
      text-transform: uppercase;
      color: #8ab4f8;
      letter-spacing: 0.5px;
      border-top: 1px solid rgba(100, 150, 255, 0.15);
      padding-top: 8px;
    }

    .panel h3:first-of-type {
      border-top: none;
      padding-top: 0;
      margin-top: 0;
    }

    .info-item, .control-group {
      margin-bottom: 6px;
    }

    .info-item {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 4px 6px;
      background: rgba(100, 150, 255, 0.05);
      border-radius: 4px;
    }

    .info-item strong {
      color: #b0c4ff;
      font-weight: 500;
    }

    .info-item span {
      color: #4da6ff;
      font-weight: 600;
    }

    .control-group {
      padding: 6px;
      background: rgba(100, 150, 255, 0.03);
      border-radius: 4px;
    }

    .control-group label {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 4px;
      font-weight: 500;
      color: #b0c4ff;
    }

    .control-group .value-display {
      color: #4da6ff;
      font-weight: 600;
      min-width: 50px;
      text-align: right;
    }

    input[type="range"] {
      width: 100%;
      height: 5px;
      border-radius: 3px;
      background: rgba(100, 150, 255, 0.2);
      outline: none;
      -webkit-appearance: none;
      appearance: none;
      cursor: pointer;
      margin-top: 4px;
    }

    input[type="range"]::-webkit-slider-thumb {
      -webkit-appearance: none;
      appearance: none;
      width: 14px;
      height: 14px;
      border-radius: 50%;
      background: #4da6ff;
      cursor: pointer;
      box-shadow: 0 0 8px rgba(77, 166, 255, 0.6);
      transition: all 0.2s ease;
    }

    input[type="range"]::-webkit-slider-thumb:hover {
      background: #6bc5ff;
      box-shadow: 0 0 12px rgba(77, 166, 255, 0.8);
    }

    input[type="range"]::-moz-range-thumb {
      width: 14px;
      height: 14px;
      border-radius: 50%;
      background: #4da6ff;
      cursor: pointer;
      border: none;
      box-shadow: 0 0 8px rgba(77, 166, 255, 0.6);
      transition: all 0.2s ease;
    }

    input[type="range"]::-moz-range-thumb:hover {
      background: #6bc5ff;
      box-shadow: 0 0 12px rgba(77, 166, 255, 0.8);
    }

    .button-group {
      display: flex;
      gap: 6px;
      margin-top: 10px;
      margin-bottom: 10px;
    }

    .button-group button {
      flex: 1;
      padding: 6px 10px;
      border: none;
      border-radius: 5px;
      background: rgba(77, 166, 255, 0.2);
      color: #4da6ff;
      font-weight: 600;
      font-size: 12px;
      cursor: pointer;
      transition: all 0.2s ease;
      text-transform: uppercase;
      letter-spacing: 0.5px;
      min-width: 80px;
      white-space: nowrap;
    }

    .button-group button:hover {
      background: rgba(77, 166, 255, 0.4);
      box-shadow: 0 0 12px rgba(77, 166, 255, 0.4);
    }

    .button-group button:active {
      background: rgba(77, 166, 255, 0.6);
    }

    .button-group button.active {
      background: rgba(77, 166, 255, 0.6);
      box-shadow: 0 0 16px rgba(77, 166, 255, 0.6);
    }

    /* Toggle Switch pour mode contrainte */
    .constraint-mode-toggle {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 8px 10px;
      margin-bottom: 12px;
      background: rgba(100, 150, 255, 0.08);
      border-radius: 6px;
      border: 1px solid rgba(100, 150, 255, 0.15);
    }

    .constraint-mode-toggle label {
      font-size: 11px;
      font-weight: 500;
      color: #9db4d4;
      margin: 0;
    }

    .toggle-switch {
      position: relative;
      display: inline-block;
      width: 120px;
      height: 28px;
    }

    .toggle-switch input {
      opacity: 0;
      width: 0;
      height: 0;
    }

    .toggle-slider {
      position: absolute;
      cursor: pointer;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: #1a2740;
      transition: 0.3s;
      border-radius: 14px;
      border: 1px solid rgba(100, 150, 255, 0.3);
    }

    .toggle-slider:before {
      position: absolute;
      content: "";
      height: 20px;
      width: 56px;
      left: 4px;
      bottom: 3px;
      background: linear-gradient(135deg, #2563eb 0%, #1e40af 100%);
      transition: 0.3s;
      border-radius: 10px;
      box-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
    }

    .toggle-switch input:checked + .toggle-slider:before {
      transform: translateX(56px);
      background: linear-gradient(135deg, #10b981 0%, #059669 100%);
    }

    .toggle-labels {
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 0 12px;
      pointer-events: none;
      font-size: 10px;
      font-weight: 600;
    }

    .toggle-labels span {
      transition: color 0.3s;
      z-index: 1;
    }

    .toggle-labels .label-pbd {
      color: #fff;
    }

    .toggle-labels .label-force {
      color: #6b7280;
    }

    .toggle-switch input:checked ~ .toggle-labels .label-pbd {
      color: #6b7280;
    }

    .toggle-switch input:checked ~ .toggle-labels .label-force {
      color: #fff;
    }

  </style>
</head>
<body>
    <!-- Panneau d'informations (gauche) -->
    <div id="info-panel" class="panel">
      <h2>üìä √âtat de vol</h2>

      <h3>ü™Å Cerf-volant</h3>
      <div class="info-item">
        <strong>Vitesse:</strong>
        <span id="kite-speed-value">-- km/h</span>
      </div>
      <div class="info-item">
        <strong>Altitude:</strong>
        <span id="kite-altitude-value">-- m</span>
      </div>
      <div class="info-item">
        <strong>Position X:</strong>
        <span id="kite-position-x-value">-- m</span>
      </div>
      <div class="info-item">
        <strong>Position Z:</strong>
        <span id="kite-position-z-value">-- m</span>
      </div>
      <div class="info-item">
        <strong>Angle d'attaque:</strong>
        <span id="kite-aoa-value">-- ¬∞</span>
      </div>

      <h3>‚ö° Forces</h3>
      <div class="info-item">
        <strong>Portance:</strong>
        <span id="kite-lift-value">-- N</span>
      </div>
      <div class="info-item">
        <strong>Tra√Æn√©e:</strong>
        <span id="kite-drag-value">-- N</span>
      </div>
      <div class="info-item">
        <strong>Tension ligne G:</strong>
        <span id="tension-left-value">-- N</span>
      </div>
      <div class="info-item">
        <strong>Tension ligne D:</strong>
        <span id="tension-right-value">-- N</span>
      </div>

      <h3>üí® Environnement</h3>
      <div class="info-item">
        <strong>Vent ambiant:</strong>
        <span id="wind-info-value">-- m/s</span>
      </div>
      <div class="info-item">
        <strong>Vent apparent:</strong>
        <span id="wind-apparent-value">-- m/s</span>
      </div>
      <div class="info-item">
        <strong>Direction vent:</strong>
        <span id="wind-direction-value">-- ¬∞</span>
      </div>

      <h3>üìè Distances lignes</h3>
      <div class="info-item">
        <strong>Ligne G (actuelle):</strong>
        <span id="line-left-actual-value">-- m</span>
      </div>
      <div class="info-item">
        <strong>Ligne G (config):</strong>
        <span id="line-left-expected-value">-- m</span>
      </div>
      <div class="info-item">
        <strong>Ligne D (actuelle):</strong>
        <span id="line-right-actual-value">-- m</span>
      </div>
      <div class="info-item">
        <strong>Ligne D (config):</strong>
        <span id="line-right-expected-value">-- m</span>
      </div>
      <div class="info-item">
        <strong>√âcart ligne G:</strong>
        <span id="line-left-diff-value">-- m</span>
      </div>
      <div class="info-item">
        <strong>√âcart ligne D:</strong>
        <span id="line-right-diff-value">-- m</span>
      </div>
    </div>

    <!-- Panneau de contr√¥les (droite) -->
    <div id="controls-panel" class="panel">
      <h2>‚öôÔ∏è Contr√¥les Simulation</h2>

      <!-- Mode de contrainte -->
      <div class="constraint-mode-toggle">
        <label>Mode Contrainte</label>
        <label class="toggle-switch">
          <input type="checkbox" id="constraint-mode-toggle">
          <span class="toggle-slider"></span>
          <div class="toggle-labels">
            <span class="label-pbd">PBD</span>
            <span class="label-force">Force</span>
          </div>
        </label>
      </div>

      <!-- Boutons de contr√¥le en haut -->
      <div class="button-group">
        <button id="play-pause">‚ñ∂Ô∏è D√©marrer</button>
        <button id="reset-sim">üîÑ Reset</button>
        <button id="debug-toggle">üîç Debug</button>
      </div>
      
      <!-- Vent -->
      <h3>üí® Vent</h3>
      <div class="control-group">
        <label for="wind-speed-slider">
          Vitesse
          <span class="value-display" id="wind-speed-value">10 m/s</span>
        </label>
        <input type="range" id="wind-speed-slider" min="0" max="30" step="0.5" value="10">
      </div>

      <div class="control-group">
        <label for="wind-direction-slider">
          Direction
          <span class="value-display" id="wind-direction-value">0¬∞</span>
        </label>
        <input type="range" id="wind-direction-slider" min="0" max="360" step="1" value="0">
      </div>

      <div class="control-group">
        <label for="wind-turbulence-slider">
          Turbulence
          <span class="value-display" id="wind-turbulence-value">10%</span>
        </label>
        <input type="range" id="wind-turbulence-slider" min="0" max="100" step="1" value="10">
      </div>

      <!-- Lignes -->
      <h3>üîó Lignes & Brides</h3>
      <div class="control-group">
        <label for="line-length-slider">
          Longueur lignes
          <span class="value-display" id="line-length-value">150m</span>
        </label>
        <input type="range" id="line-length-slider" min="20" max="300" step="1" value="150">
      </div>

      <div class="control-group">
        <label for="bridle-nez-slider">
          Bride nez
          <span class="value-display" id="bridle-nez-value">1.50m</span>
        </label>
        <input type="range" id="bridle-nez-slider" min="0.5" max="5" step="0.1" value="1.5">
      </div>

      <div class="control-group">
        <label for="bridle-inter-slider">
          Bride inter
          <span class="value-display" id="bridle-inter-value">2.00m</span>
        </label>
        <input type="range" id="bridle-inter-slider" min="0.5" max="5" step="0.1" value="2.0">
      </div>

      <div class="control-group">
        <label for="bridle-centre-slider">
          Bride centre
          <span class="value-display" id="bridle-centre-value">2.50m</span>
        </label>
        <input type="range" id="bridle-centre-slider" min="0.5" max="5" step="0.1" value="2.5">
      </div>

      <!-- Physique -->
      <h3>‚öôÔ∏è Physique</h3>
      <div class="control-group">
        <label for="linear-damping-slider">
          Amortissement lin√©aire
          <span class="value-display" id="linear-damping-value">0.99</span>
        </label>
        <input type="range" id="linear-damping-slider" min="0" max="1" step="0.01" value="0.99">
      </div>

      <div class="control-group">
        <label for="angular-damping-slider">
          Amortissement angulaire
          <span class="value-display" id="angular-damping-value">0.98</span>
        </label>
        <input type="range" id="angular-damping-slider" min="0" max="1" step="0.01" value="0.98">
      </div>

      <div class="control-group">
        <label for="mesh-subdivision-slider">
          Subdivision maillage
          <span class="value-display" id="mesh-subdivision-value">2</span>
        </label>
        <input type="range" id="mesh-subdivision-slider" min="0" max="4" step="1" value="2">
      </div>

      <!-- A√©rodynamique -->
      <h3>üå™Ô∏è A√©rodynamique</h3>
      <div class="control-group">
        <label for="lift-scale-slider">
          √âchelle portance
          <span class="value-display" id="lift-scale-value">1.00</span>
        </label>
        <input type="range" id="lift-scale-slider" min="0" max="2" step="0.1" value="1.0">
      </div>

      <div class="control-group">
        <label for="drag-scale-slider">
          √âchelle tra√Æn√©e
          <span class="value-display" id="drag-scale-value">1.00</span>
        </label>
        <input type="range" id="drag-scale-slider" min="0" max="2" step="0.1" value="1.0">
      </div>

      <div class="control-group">
        <label for="force-smoothing-slider">
          Lissage forces
          <span class="value-display" id="force-smoothing-value">0.50</span>
        </label>
        <input type="range" id="force-smoothing-slider" min="0" max="1" step="0.1" value="0.5">
      </div>
    </div>

    <script type="module" src="/src/ecs/main.ts"></script>
</body>
</html>
